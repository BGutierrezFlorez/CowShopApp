<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel de Usuario - CowShop</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- FontAwesome para √≠conos -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Tu CSS personalizado -->
  <link rel="stylesheet" href="css/index.css">
  <link rel="stylesheet" href="css/paneldeusuario.css">
</head>
<body>

  <!-- HEADER -->
  <header class="main-header fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container">
        <a class="navbar-brand" href="index.html">
          <img src="media/logotipo.png" alt="CowShop Logo" class="logo-img">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link active" href="index.html">Inicio</a></li>
            <li class="nav-item"><a class="nav-link" href="tienda.html">Tienda</a></li>
            <li class="nav-item"><a class="nav-link" href="Nosotros.html">Nosotros</a></li>
            <li class="nav-item"><a class="nav-link" href="contacto.html">Contacto</a></li>
            <li class="nav-item"><a class="nav-link" href="planes.html">Planes</a></li>
          </ul>
          <a href="logout.html" class="btn btn-secondary ms-3">Cerrar Sesi√≥n</a>
        </div>
      </div>
    </nav>
  </header>

  <!-- BIENVENIDA AL USUARIO -->
  <section class="user-welcome">
    <div class="container text-center">
      <h2 class="mt-5 pt-5">üëã ¬°Bienvenido/a, <span class="text-primary fw-bold">Juan P√©rez</span>!</h2>
      <p class="lead">Nos alegra tenerte de nuevo en <strong>CowShop</strong>. Aqu√≠ puedes gestionar tu membres√≠a.</p>
    </div>
  </section>

  <!-- SECCI√ìN DE MEMBRES√çAS -->
  <section class="membership-section">
    <div class="container">
      <h2 class="mb-3">Planes de Membres√≠a</h2>
      <p>Elige el plan que mejor se adapte a tus necesidades.</p>

      <div class="pricing-cards">

        <!-- PLAN B√ÅSICO -->
        <div class="pricing-card basic">
          <img src="media/image-100.png" alt="Plan B√°sico">
          <div class="pricing-card-body">
            <h3>B√°sico</h3>
            <div class="price">$100.000 <span>/mes</span></div>
            <ul>
              <li><i class="fa fa-check"></i> Acceso a cat√°logo b√°sico</li>
              <li><i class="fa fa-check"></i> 1 asesor√≠a mensual por correo</li>
              <li><i class="fa fa-check"></i> Certificado de salud b√°sico</li>
              <li><i class="fa fa-times"></i> Descuentos especiales</li>
            </ul>
            <a href="pago.html?plan=Basico" class="btn-select btn btn-primary">Seleccionar plan</a>
          </div>
        </div>

        <!-- PLAN PROFESIONAL -->
        <div class="pricing-card professional">
          <img src="media/plan2.jpg" alt="Plan Profesional">
          <div class="pricing-card-body">
            <h3>Profesional</h3>
            <div class="price">$150.000 <span>/mes</span></div>
            <ul>
              <li><i class="fa fa-check"></i> Todo lo del plan B√°sico</li>
              <li><i class="fa fa-check"></i> Acceso a cat√°logo premium</li>
              <li><i class="fa fa-check"></i> 2 asesor√≠as (email/llamada)</li>
              <li><i class="fa fa-check"></i> 10% de descuento en compras</li>
            </ul>
            <a href="pago.html?plan=Profesional" class="btn-select btn btn-primary">Seleccionar plan</a>
          </div>
        </div>

        <!-- PLAN PREMIUM -->
        <div class="pricing-card premium">
          <img src="media/plan3.jpg" alt="Plan Premium">
          <div class="pricing-card-body">
            <h3>Premium</h3>
            <div class="price">$200.000 <span>/mes</span></div>
            <ul>
              <li><i class="fa fa-check"></i> Todo lo del plan Profesional</li>
              <li><i class="fa fa-check"></i> Asesor√≠a prioritaria ilimitada</li>
              <li><i class="fa fa-check"></i> 1 visita t√©cnica anual</li>
              <li><i class="fa fa-check"></i> 15% de descuento en compras</li>
            </ul>
            <a href="pago.html?plan=Premium" class="btn-select btn btn-primary">Seleccionar plan</a>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="main-footer py-4 text-white text-center">
    <div class="container">
      <p class="mb-0">¬© 2025 CowShop - Todos los derechos reservados</p>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/session.js"></script>
  <script>
    (function() {
      // Helpers para otras p√°ginas del panel
      window.getAuthHeaders = function() {
        const t = localStorage.getItem('cowshop_token');
        return t ? { 'Authorization': 'Bearer ' + t } : {};
      };

      window.getTokenPayload = function() {
        const t = localStorage.getItem('cowshop_token');
        if (!t) return null;
        try { return JSON.parse(atob(t.split('.')[1])); } catch { return null; }
      };

      // Mostrar nombre y datos del token en la UI
  const name = localStorage.getItem('cowshop_user_name');
      const span = document.querySelector('.user-welcome h2 span');
      if (name && span) span.textContent = name;

      const payload = window.getTokenPayload();
      if (!payload) {
        // No autenticado
        localStorage.removeItem('cowshop_token');
        window.location.href = 'login.html';
        return;
      }

      // Mostrar rol e id en el UI si existen
      if (payload.id) {
        const small = document.createElement('p');
        small.className = 'text-muted';
        small.textContent = 'ID: ' + payload.id + (payload.rol ? ' ‚Ä¢ Rol: ' + payload.rol : '');
        const container = document.querySelector('.user-welcome .container');
        if (container) container.appendChild(small);
      }

      // Logout: limpiar sessionStorage y redirigir
      function doLogout() {
        localStorage.removeItem('cowshop_token');
        localStorage.removeItem('cowshop_user_name');
        window.location.href = 'login.html';
      }

      // Enlazar botones/links de logout existentes
      const logoutLinks = document.querySelectorAll('a[href="logout.html"], a[href="#"].logout');
      logoutLinks.forEach(a => a.addEventListener('click', (e) => {
        e.preventDefault();
        doLogout();
      }));
    })();
  </script>
</body>
</html>
